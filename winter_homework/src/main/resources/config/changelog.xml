<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">

    <changeSet id="create_web_user" author="Jane">
        <createTable tableName="web_user">
            <column name="id" type="int" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(20)"/>
            <column name="password" type="varchar(20)">
            </column>
        </createTable>
    </changeSet>

    <changeSet id="admin_default" author="Jane">
        <createTable tableName="admin_user">
            <column name="id" type="int" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(20)"/>
            <column name="password" type="varchar(20)">
            </column>
        </createTable>
    </changeSet>

    <changeSet id="create_commodity" author="Jane">
        <createTable tableName="commodity">
            <column name="id" type="int" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="name" type="varchar(20)"/>
            <column name="com_desc" type="varchar(200)"/>
            <column name="img_url" type="varchar(100)"/>
            <column name="old_price" type="double"/>
            <column name="new_price" type="double"/>
            <column name="stock" type="int"/>
            <column name="sales_volume" type="int"/>
            <column name="owner_id" type="int">
                <constraints nullable="false" foreignKeyName="fk_commodity_admin_user" references="admin_user(id)"/>
            </column>
            <column name="publish_date" type="date"/>
        </createTable>
    </changeSet>


    <changeSet id="create_order" author="Jane">
        <createTable tableName="db_order">
            <column name="id" type="int" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="buyer_id" type="int">
                <constraints nullable="false" foreignKeyName="fk_order_web_user" references="web_user(id)"/>
            </column>
            <column name="seller_id" type="int">
                <constraints nullable="false" foreignKeyName="fk_order_admin_user" references="admin_user(id)"/>
            </column>
            <column name="date" type="date"/>
            <column name="status" type="varchar(20)"/>
        </createTable>
    </changeSet>

    <changeSet id="create_purchase" author="Jane">
        <createTable tableName="single_purchase_info">
            <column name="id" type="int" autoIncrement="true">
                <constraints primaryKey="true"/>
            </column>
            <column name="buyer_id" type="int">
                <constraints nullable="false" foreignKeyName="fk_purchase_web_user" references="web_user(id)"/>
            </column>
            <column name="commodity_id" type="int">
                <constraints nullable="false" foreignKeyName="fk_purchase_commodity" references="commodity(id)"/>
            </column>
            <column name="order_id" type="int">
                <constraints nullable="true" foreignKeyName="fk_purchase_order" references="db_order(id)"/>
            </column>
            <column name="num" type="int"/>
            <column name="date" type="date"/>
            <column name="status" type="varchar(20)"/>
        </createTable>
    </changeSet>





    <changeSet id="t" author="Jane" runAlways="true">
        <insert tableName="admin_user">
            <column name="name" value="admin"/>
            <column name="password" value="admin"/>
        </insert>
    </changeSet>

    <changeSet id="2" author="Jane" runAlways="true">
        <insert tableName="web_user">
            <column name="name" value="Jane"/>
            <column name="password" value="Password"/>
        </insert>
    </changeSet>

    <changeSet id="3" author="Jane">
        <insert tableName="web_user">
            <column name="name" value="Lily"/>
            <column name="password" value="123456"/>
        </insert>
        <rollback>delete from debug_info</rollback>
    </changeSet>

    <changeSet id="4" author="Jane" dbms="postgresql">
        <insert tableName="web_user">
            <column name="name" value="Kitty"/>
            <column name="password" value="mima"/>
        </insert>
        <rollback/>
    </changeSet>

    <changeSet id="5" author="Jane" dbms="postgresql">
        <insert tableName="commodity">
            <column name="name" value="牙刷"/>
            <column name="com_desc" value="高露洁牙刷"/>
            <column name="img_url" value="../src/img"/>
            <column name="old_price" value="12"/>
            <column name="new_price" value="2"/>
            <column name="stock" value="23"/>
            <column name="sales_volume" value="12"/>
            <column name="owner_id" value="1"/>
        </insert>
        <rollback/>
    </changeSet>

    <changeSet id="6" author="Jane" dbms="postgresql">
        <insert tableName="single_purchase_info">
            <column name="buyer_id" value="1"/>
            <column name="commodity_id" value="1"/>
            <column name="num" value="2"/>
            <column name="date"  valueComputed="current_datetime"/>
            <column name="status" value="inCart"/>
        </insert>
        <rollback/>
    </changeSet>

    <changeSet id="7" author="Jane" dbms="postgresql">
        <insert tableName="single_purchase_info">
            <column name="buyer_id" value="2"/>
            <column name="commodity_id" value="1"/>
            <column name="num" value="1"/>
            <column name="date"  valueComputed="current_datetime"/>
            <column name="status" value="Order"/>
        </insert>
        <rollback/>
    </changeSet>

    <changeSet id="8" author="Jane" dbms="postgresql">
        <insert tableName="db_order">
            <column name="buyer_id" value="2"/>
            <column name="seller_id" value="1"/>
            <column name="date"  valueComputed="current_datetime"/>
            <column name="status" value="Order"/>
        </insert>
        <rollback/>
    </changeSet>

</databaseChangeLog>
